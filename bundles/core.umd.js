(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define(['exports', '@angular/core', '@angular/common'], factory) :
    (factory((global.ng2Webstorage = global.ng2Webstorage || {}),global.ng.core,global.ng.common));
}(this, (function (exports,_angular_core,_angular_common) { 'use strict';

var State = {
    Open: 'open',
    Collapsing: 'collapsing',
    Collapsed: 'collapsed'
};

var AccordionStyle = {
    Height: 'height',
    Duration: 'transitionDuration'
};

var __decorate$1 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var Accordion = (function () {
    function Accordion() {
        this.classes = {};
        this.optStyle = {};
        this._duration = 300;
        this.timers = [];
        this.stateChange = new _angular_core.EventEmitter();
        this.classes[State.Open] = true;
        this.classes[State.Collapsing] = false;
        this.classes[State.Collapsed] = false;
        this.optStyle[AccordionStyle.Duration] = this._duration + "ms";
    }
    Object.defineProperty(Accordion.prototype, "collapse", {
        set: function (value) { this.toggle(value); },
        enumerable: true,
        configurable: true
    });
    
    Object.defineProperty(Accordion.prototype, "duration", {
        set: function (duration) {
            this._duration = duration || this._duration;
            this.optStyle[AccordionStyle.Duration] = this._duration + "ms";
        },
        enumerable: true,
        configurable: true
    });
    
    Object.defineProperty(Accordion.prototype, "contentNode", {
        get: function () { return this.content.nativeElement; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Accordion.prototype, "contentHeight", {
        get: function () { return this.contentNode.getBoundingClientRect().height; },
        enumerable: true,
        configurable: true
    });
    Accordion.prototype.open = function () {
        var _this = this;
        this.optStyle[AccordionStyle.Height] = 0;
        this.classes[State.Collapsed] = false;
        this.classes[State.Collapsing] = this.classes[State.Open] = true;
        this.optStyle[AccordionStyle.Height] = 0;
        var timer = setTimeout(function () { return _this.optStyle[AccordionStyle.Height] = _this.contentHeight; }, 1);
        this.timers.push(timer);
        timer = setTimeout(function () {
            delete _this.optStyle[AccordionStyle.Height];
            _this.classes[State.Collapsing] = false;
            _this.stateChange.emit(true);
        }, this._duration);
        this.timers.push(timer);
    };
    Accordion.prototype.close = function () {
        var _this = this;
        this.optStyle[AccordionStyle.Height] = this.contentHeight;
        this.classes[State.Open] = false;
        this.classes[State.Collapsing] = true;
        var timer = setTimeout(function () { return _this.optStyle[AccordionStyle.Height] = 0; }, 1);
        this.timers.push(timer);
        timer = setTimeout(function () {
            delete _this.optStyle[AccordionStyle.Height];
            _this.classes[State.Collapsing] = false;
            _this.classes[State.Collapsed] = true;
            _this.stateChange.emit(false);
        }, this._duration);
        this.timers.push(timer);
    };
    Accordion.prototype.resetTimers = function () {
        this.timers.forEach(function (timer) { return clearTimeout(timer); });
        this.timers = [];
    };
    Accordion.prototype.toggle = function (state) {
        if (state === void 0) { state = null; }
        if (this.classes[State.Open] && state === true)
            return;
        if (this.classes[State.Collapsed] && state === false)
            return;
        this.resetTimers();
        if (this.classes[State.Open])
            this.close();
        else
            this.open();
    };
    __decorate$1([
        _angular_core.ViewChild('accordionContent')
    ], Accordion.prototype, "content", void 0);
    __decorate$1([
        _angular_core.Input()
    ], Accordion.prototype, "collapse", null);
    __decorate$1([
        _angular_core.Output()
    ], Accordion.prototype, "stateChange", void 0);
    __decorate$1([
        _angular_core.Input()
    ], Accordion.prototype, "duration", null);
    Accordion = __decorate$1([
        _angular_core.Component({
            selector: 'accordion',
            template: "\n\t\t<section [ngClass]=\"classes\" [ngStyle]=\"optStyle\" class=\"accordion-container\">\n\t\t\t<article #accordionContent>\n\t\t\t\t<ng-content></ng-content>\n\t\t\t</article>\n\t\t</section>\n\t",
            styles: [("\n\t\t.accordion-container {\n\t\t\ttransition-property: height;\n\t\t\ttransition-timing-function: ease-in;\n\t\t}\n\t\t." + State.Collapsed + " {\n\t\t\tdisplay:none;\n\t\t}\n\t\t." + State.Collapsing + " {\n\t\t\toverflow:hidden;\n\t\t}\n\t")]
        })
    ], Accordion);
    return Accordion;
}());

var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var Ng2Accordion = (function () {
    function Ng2Accordion() {
    }
    Ng2Accordion = __decorate([
        _angular_core.NgModule({
            declarations: [Accordion],
            imports: [_angular_common.CommonModule],
            exports: [Accordion]
        })
    ], Ng2Accordion);
    return Ng2Accordion;
}());

// # sourceMappingURL=index.js.map

exports.Ng2Accordion = Ng2Accordion;
exports.Accordion = Accordion;

Object.defineProperty(exports, '__esModule', { value: true });

})));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29yZS51bWQuanMiLCJzb3VyY2VzIjpbIi4uL2Rpc3QvY29uc3RzL3N0YXRlLmpzIiwiLi4vZGlzdC9jb25zdHMvYWNjb3JkaW9uU3R5bGUuanMiLCIuLi9kaXN0L2NvbXBvbmVudHMvYWNjb3JkaW9uLmpzIiwiLi4vZGlzdC9hcHAuanMiLCIuLi9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIFN0YXRlID0ge1xyXG4gICAgT3BlbjogJ29wZW4nLFxyXG4gICAgQ29sbGFwc2luZzogJ2NvbGxhcHNpbmcnLFxyXG4gICAgQ29sbGFwc2VkOiAnY29sbGFwc2VkJ1xyXG59O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdGF0ZS5qcy5tYXAiLCJleHBvcnQgdmFyIEFjY29yZGlvblN0eWxlID0ge1xyXG4gICAgSGVpZ2h0OiAnaGVpZ2h0JyxcclxuICAgIER1cmF0aW9uOiAndHJhbnNpdGlvbkR1cmF0aW9uJ1xyXG59O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hY2NvcmRpb25TdHlsZS5qcy5tYXAiLCJ2YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG5pbXBvcnQgeyBJbnB1dCwgQ29tcG9uZW50LCBWaWV3Q2hpbGQsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFN0YXRlIH0gZnJvbSAnLi4vY29uc3RzL3N0YXRlJztcclxuaW1wb3J0IHsgQWNjb3JkaW9uU3R5bGUgfSBmcm9tICcuLi9jb25zdHMvYWNjb3JkaW9uU3R5bGUnO1xyXG5leHBvcnQgdmFyIEFjY29yZGlvbiA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBY2NvcmRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jbGFzc2VzID0ge307XHJcbiAgICAgICAgdGhpcy5vcHRTdHlsZSA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2R1cmF0aW9uID0gMzAwO1xyXG4gICAgICAgIHRoaXMudGltZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgICAgICB0aGlzLmNsYXNzZXNbU3RhdGUuT3Blbl0gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuY2xhc3Nlc1tTdGF0ZS5Db2xsYXBzaW5nXSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2xhc3Nlc1tTdGF0ZS5Db2xsYXBzZWRdID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5vcHRTdHlsZVtBY2NvcmRpb25TdHlsZS5EdXJhdGlvbl0gPSB0aGlzLl9kdXJhdGlvbiArIFwibXNcIjtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY2NvcmRpb24ucHJvdG90eXBlLCBcImNvbGxhcHNlXCIsIHtcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkgeyB0aGlzLnRvZ2dsZSh2YWx1ZSk7IH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjY29yZGlvbi5wcm90b3R5cGUsIFwiZHVyYXRpb25cIiwge1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2R1cmF0aW9uID0gZHVyYXRpb24gfHwgdGhpcy5fZHVyYXRpb247XHJcbiAgICAgICAgICAgIHRoaXMub3B0U3R5bGVbQWNjb3JkaW9uU3R5bGUuRHVyYXRpb25dID0gdGhpcy5fZHVyYXRpb24gKyBcIm1zXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICA7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWNjb3JkaW9uLnByb3RvdHlwZSwgXCJjb250ZW50Tm9kZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudDsgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWNjb3JkaW9uLnByb3RvdHlwZSwgXCJjb250ZW50SGVpZ2h0XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuY29udGVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0OyB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEFjY29yZGlvbi5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMub3B0U3R5bGVbQWNjb3JkaW9uU3R5bGUuSGVpZ2h0XSA9IDA7XHJcbiAgICAgICAgdGhpcy5jbGFzc2VzW1N0YXRlLkNvbGxhcHNlZF0gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNsYXNzZXNbU3RhdGUuQ29sbGFwc2luZ10gPSB0aGlzLmNsYXNzZXNbU3RhdGUuT3Blbl0gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMub3B0U3R5bGVbQWNjb3JkaW9uU3R5bGUuSGVpZ2h0XSA9IDA7XHJcbiAgICAgICAgdmFyIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5vcHRTdHlsZVtBY2NvcmRpb25TdHlsZS5IZWlnaHRdID0gX3RoaXMuY29udGVudEhlaWdodDsgfSwgMSk7XHJcbiAgICAgICAgdGhpcy50aW1lcnMucHVzaCh0aW1lcik7XHJcbiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZGVsZXRlIF90aGlzLm9wdFN0eWxlW0FjY29yZGlvblN0eWxlLkhlaWdodF07XHJcbiAgICAgICAgICAgIF90aGlzLmNsYXNzZXNbU3RhdGUuQ29sbGFwc2luZ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgX3RoaXMuc3RhdGVDaGFuZ2UuZW1pdCh0cnVlKTtcclxuICAgICAgICB9LCB0aGlzLl9kdXJhdGlvbik7XHJcbiAgICAgICAgdGhpcy50aW1lcnMucHVzaCh0aW1lcik7XHJcbiAgICB9O1xyXG4gICAgQWNjb3JkaW9uLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMub3B0U3R5bGVbQWNjb3JkaW9uU3R5bGUuSGVpZ2h0XSA9IHRoaXMuY29udGVudEhlaWdodDtcclxuICAgICAgICB0aGlzLmNsYXNzZXNbU3RhdGUuT3Blbl0gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNsYXNzZXNbU3RhdGUuQ29sbGFwc2luZ10gPSB0cnVlO1xyXG4gICAgICAgIHZhciB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMub3B0U3R5bGVbQWNjb3JkaW9uU3R5bGUuSGVpZ2h0XSA9IDA7IH0sIDEpO1xyXG4gICAgICAgIHRoaXMudGltZXJzLnB1c2godGltZXIpO1xyXG4gICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5vcHRTdHlsZVtBY2NvcmRpb25TdHlsZS5IZWlnaHRdO1xyXG4gICAgICAgICAgICBfdGhpcy5jbGFzc2VzW1N0YXRlLkNvbGxhcHNpbmddID0gZmFsc2U7XHJcbiAgICAgICAgICAgIF90aGlzLmNsYXNzZXNbU3RhdGUuQ29sbGFwc2VkXSA9IHRydWU7XHJcbiAgICAgICAgICAgIF90aGlzLnN0YXRlQ2hhbmdlLmVtaXQoZmFsc2UpO1xyXG4gICAgICAgIH0sIHRoaXMuX2R1cmF0aW9uKTtcclxuICAgICAgICB0aGlzLnRpbWVycy5wdXNoKHRpbWVyKTtcclxuICAgIH07XHJcbiAgICBBY2NvcmRpb24ucHJvdG90eXBlLnJlc2V0VGltZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudGltZXJzLmZvckVhY2goZnVuY3Rpb24gKHRpbWVyKSB7IHJldHVybiBjbGVhclRpbWVvdXQodGltZXIpOyB9KTtcclxuICAgICAgICB0aGlzLnRpbWVycyA9IFtdO1xyXG4gICAgfTtcclxuICAgIEFjY29yZGlvbi5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKHN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHN0YXRlID09PSB2b2lkIDApIHsgc3RhdGUgPSBudWxsOyB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2xhc3Nlc1tTdGF0ZS5PcGVuXSAmJiBzdGF0ZSA9PT0gdHJ1ZSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0aGlzLmNsYXNzZXNbU3RhdGUuQ29sbGFwc2VkXSAmJiBzdGF0ZSA9PT0gZmFsc2UpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLnJlc2V0VGltZXJzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY2xhc3Nlc1tTdGF0ZS5PcGVuXSlcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgVmlld0NoaWxkKCdhY2NvcmRpb25Db250ZW50JylcclxuICAgIF0sIEFjY29yZGlvbi5wcm90b3R5cGUsIFwiY29udGVudFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5wdXQoKVxyXG4gICAgXSwgQWNjb3JkaW9uLnByb3RvdHlwZSwgXCJjb2xsYXBzZVwiLCBudWxsKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIE91dHB1dCgpXHJcbiAgICBdLCBBY2NvcmRpb24ucHJvdG90eXBlLCBcInN0YXRlQ2hhbmdlXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICBJbnB1dCgpXHJcbiAgICBdLCBBY2NvcmRpb24ucHJvdG90eXBlLCBcImR1cmF0aW9uXCIsIG51bGwpO1xyXG4gICAgQWNjb3JkaW9uID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgQ29tcG9uZW50KHtcclxuICAgICAgICAgICAgc2VsZWN0b3I6ICdhY2NvcmRpb24nLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogXCJcXG5cXHRcXHQ8c2VjdGlvbiBbbmdDbGFzc109XFxcImNsYXNzZXNcXFwiIFtuZ1N0eWxlXT1cXFwib3B0U3R5bGVcXFwiIGNsYXNzPVxcXCJhY2NvcmRpb24tY29udGFpbmVyXFxcIj5cXG5cXHRcXHRcXHQ8YXJ0aWNsZSAjYWNjb3JkaW9uQ29udGVudD5cXG5cXHRcXHRcXHRcXHQ8bmctY29udGVudD48L25nLWNvbnRlbnQ+XFxuXFx0XFx0XFx0PC9hcnRpY2xlPlxcblxcdFxcdDwvc2VjdGlvbj5cXG5cXHRcIixcclxuICAgICAgICAgICAgc3R5bGVzOiBbKFwiXFxuXFx0XFx0LmFjY29yZGlvbi1jb250YWluZXIge1xcblxcdFxcdFxcdHRyYW5zaXRpb24tcHJvcGVydHk6IGhlaWdodDtcXG5cXHRcXHRcXHR0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjogZWFzZS1pbjtcXG5cXHRcXHR9XFxuXFx0XFx0LlwiICsgU3RhdGUuQ29sbGFwc2VkICsgXCIge1xcblxcdFxcdFxcdGRpc3BsYXk6bm9uZTtcXG5cXHRcXHR9XFxuXFx0XFx0LlwiICsgU3RhdGUuQ29sbGFwc2luZyArIFwiIHtcXG5cXHRcXHRcXHRvdmVyZmxvdzpoaWRkZW47XFxuXFx0XFx0fVxcblxcdFwiKV1cclxuICAgICAgICB9KVxyXG4gICAgXSwgQWNjb3JkaW9uKTtcclxuICAgIHJldHVybiBBY2NvcmRpb247XHJcbn0oKSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjY29yZGlvbi5qcy5tYXAiLCJ2YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG5pbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBBY2NvcmRpb24gfSBmcm9tICcuL2NvbXBvbmVudHMvYWNjb3JkaW9uJztcclxuZXhwb3J0ICogZnJvbSAnLi9jb21wb25lbnRzL2FjY29yZGlvbic7XHJcbmV4cG9ydCB2YXIgTmcyQWNjb3JkaW9uID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE5nMkFjY29yZGlvbigpIHtcclxuICAgIH1cclxuICAgIE5nMkFjY29yZGlvbiA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIE5nTW9kdWxlKHtcclxuICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbQWNjb3JkaW9uXSxcclxuICAgICAgICAgICAgaW1wb3J0czogW0NvbW1vbk1vZHVsZV0sXHJcbiAgICAgICAgICAgIGV4cG9ydHM6IFtBY2NvcmRpb25dXHJcbiAgICAgICAgfSlcclxuICAgIF0sIE5nMkFjY29yZGlvbik7XHJcbiAgICByZXR1cm4gTmcyQWNjb3JkaW9uO1xyXG59KCkpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9kaXN0L2FwcCc7XHJcbi8vICMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcclxuIl0sIm5hbWVzIjpbIl9fZGVjb3JhdGUiLCJ0aGlzIiwiRXZlbnRFbWl0dGVyIiwiVmlld0NoaWxkIiwiSW5wdXQiLCJPdXRwdXQiLCJDb21wb25lbnQiLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQU8sSUFBSSxLQUFLLEdBQUc7SUFDZixJQUFJLEVBQUUsTUFBTTtJQUNaLFVBQVUsRUFBRSxZQUFZO0lBQ3hCLFNBQVMsRUFBRSxXQUFXO0NBQ3pCLENBQUMsQUFDRjs7QUNMTyxJQUFJLGNBQWMsR0FBRztJQUN4QixNQUFNLEVBQUUsUUFBUTtJQUNoQixRQUFRLEVBQUUsb0JBQW9CO0NBQ2pDLENBQUMsQUFDRjs7QUNKQSxJQUFJQSxZQUFVLEdBQUcsQ0FBQ0MsU0FBSSxJQUFJQSxTQUFJLENBQUMsVUFBVSxDQUFDLElBQUksVUFBVSxVQUFVLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUU7SUFDbkYsSUFBSSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxNQUFNLEdBQUcsSUFBSSxLQUFLLElBQUksR0FBRyxJQUFJLEdBQUcsTUFBTSxDQUFDLHdCQUF3QixDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzdILElBQUksT0FBTyxPQUFPLEtBQUssUUFBUSxJQUFJLE9BQU8sT0FBTyxDQUFDLFFBQVEsS0FBSyxVQUFVLEVBQUUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDMUgsS0FBSyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxD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
